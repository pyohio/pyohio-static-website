---
import { ViewTransitions } from 'astro:transitions'
import { getSiteMetadata } from '../utils/constants'

const { title, description, url, image, author } = Astro.props

// Get all site metadata using Astro's built-in config values
const metadata = getSiteMetadata(Astro.site, import.meta.env.BASE_URL)
const {
  eventName,
  eventDescription,
  organizationName,
  fullSiteUrl,
  siteUrl,
  ogImageUrl,
  startDate,
  endDate,
  twitterHandle,
  keywords,
} = metadata
---

<!-- general meta -->
<meta name="title" set:html={`content="${title} - ${eventName}"`} />
<meta name="description" set:html={`content="${description}"`} />
<meta name="author" set:html={`content="${author}"`} />

<!-- open graph -->
<meta property="og:title" set:html={`content="${title} - ${eventName}"`} />
<meta property="og:description" set:html={`content="${description}"`} />
<meta property="og:type" content="website" />
<meta property="og:url" set:html={`content="${url}"`} />
<meta property="og:image" set:html={`content="${ogImageUrl}"`} />

<!-- twitter card -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" set:html={`content="${title} - ${eventName}"`} />
<meta name="twitter:description" set:html={`content="${description}"`} />
<meta name="twitter:image" set:html={`content="${ogImageUrl}"`} />
<meta name="twitter:site" set:html={`content="${twitterHandle}"`} />

<!-- event schema -->
<script
  type="application/ld+json"
  set:html={JSON.stringify({
    '@context': 'https://schema.org',
    '@type': 'Event',
    '@id': `${fullSiteUrl}#event`,
    name: eventName,
    description: eventDescription,
    image: ogImageUrl,
    url: fullSiteUrl,
    eventAttendanceMode: 'https://schema.org/OnlineEventAttendanceMode',
    eventStatus: 'https://schema.org/EventScheduled',
    startDate: startDate,
    endDate: endDate,
    location: {
      '@type': 'VirtualLocation',
      url: fullSiteUrl,
    },
    organizer: {
      '@type': 'Organization',
      name: organizationName,
      url: siteUrl,
      logo: ogImageUrl,
    },
    offers: {
      '@type': 'Offer',
      price: '0',
      priceCurrency: 'USD',
      availability: 'https://schema.org/InStock',
      url: fullSiteUrl,
    },
    audience: {
      '@type': 'Audience',
      audienceType: metadata.audience,
    },
    about: ['Python', 'Programming', 'Software Development', 'Conference'],
    keywords: keywords,
    inLanguage: 'en-US',
  })}
/>
<!-- page title -->
<title>{title} - {eventName}</title>

<ViewTransitions />
